import { VSCodeButton } from "@vscode/webview-ui-toolkit/react";
import { useEffect, useRef, useState } from "react";
import { vscode } from "./utilities/vscode";
import tunes from "./utilities/tunes";
import TuneTile from './components/Tile';
import { FaStop } from 'react-icons/fa';
const App = () => {
  const [playingTunes, setPlayingTunes] = useState<Set<string>>(new Set());
  const [volumes, setVolumes] = useState<Map<string, number>>(new Map());
  const audioElementsRef = useRef<Map<string, HTMLAudioElement>>(new Map());

  useEffect(() => {
    const messageHandler = (event: MessageEvent) => {
      const { type, uri, title, volume } = event.data;
      if (type === "playAudio" && title && uri) {
        if (!audioElementsRef.current.has(title)) {
          const newAudio = new Audio(uri);
          newAudio.loop = true;
          const savedVolume = volumes.get(title) ?? 1;
          newAudio.volume = savedVolume;
          audioElementsRef.current.set(title, newAudio);
          newAudio.play().catch(console.error);
          setPlayingTunes(prev => new Set([...prev, title]));
        }
      }
      if (type === "stopAudio" && title) {
        handleStopAudio(title);
      }
      if (type === "setVolume" && title && typeof volume === 'number') {
        handleVolumeChange(title, volume);
      }
    };
    window.addEventListener("message", messageHandler);
  }, [volumes]);

  const handleStopAudio = (title: string) => {
    const audioToStop = audioElementsRef.current.get(title);
    if (audioToStop) {
      audioToStop.pause();
      audioToStop.currentTime = 0;
      audioElementsRef.current.delete(title);
    }
    
    setPlayingTunes(prev => {
      const updated = new Set(prev);
      updated.delete(title);
      return updated;
    });
  };

  const handleVolumeChange = (title: string, volume: number) => {
    const audio = audioElementsRef.current.get(title);
    if (audio) {
      audio.volume = volume;
      setVolumes(prev => {
        const updated = new Map(prev);
        updated.set(title, volume);
        return updated;
      });
    }
  };

  const handleTileClick = (title: string) => {
    if (playingTunes.has(title)) {
      vscode.postMessage({ type: "stopAudio", title });
    } else {
      vscode.postMessage({ type: "playTune", title });
    }
  };

  const stopAllAudio = () => {
    playingTunes.forEach(title => {
      vscode.postMessage({ type: "stopAudio", title });
    });
  };

  return (
    <main className="flex flex-col items-center w-full min-h-screen bg-black">
    <div className="flex items-center justify-between h-14 w-[100vw] my-2">
      <div className="w-full my-4 text-2xl font-bold text-center text-lime-300">
        <svg id="svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" width="200" height="300" viewBox="0, 0, 400,300"><g id="svgg"><path id="path0" d="M115.400 149.400 L 115.400 189.400 116.400 189.400 L 117.400 189.400 117.400 149.400 L 117.400 109.400 116.400 109.400 L 115.400 109.400 115.400 149.400 M75.400 144.705 L 75.400 164.610 74.850 164.329 C 68.956 161.320,55.597 166.722,55.601 172.113 C 55.606 178.679,73.388 176.372,76.887 169.351 L 77.400 168.321 77.400 152.157 L 77.400 135.992 77.950 136.115 C 86.635 138.055,97.042 143.507,99.505 147.407 C 100.841 149.524,100.846 152.133,99.520 154.926 C 98.726 156.598,98.839 156.785,99.897 155.550 C 104.613 150.049,102.631 146.307,89.700 136.300 C 82.588 130.796,79.520 127.995,78.037 125.650 C 77.517 124.827,77.467 124.801,76.450 124.800 L 75.400 124.800 75.400 144.705 M296.823 126.009 C 290.800 127.586,288.152 131.878,286.841 142.185 L 286.500 144.870 284.829 145.229 C 281.867 145.865,281.088 146.688,281.282 148.978 C 281.471 151.214,281.707 151.356,284.662 151.028 C 286.318 150.844,286.199 150.585,285.876 153.667 C 284.042 171.158,283.225 182.788,283.761 183.748 C 284.855 185.705,289.849 184.669,291.077 182.230 C 291.565 181.261,291.591 180.130,291.200 176.800 C 290.334 169.423,290.236 160.351,290.936 152.222 L 291.063 150.744 292.881 150.866 C 293.882 150.934,295.544 151.135,296.576 151.314 C 299.180 151.766,300.100 150.961,300.650 147.752 C 301.210 144.480,299.849 143.889,292.900 144.386 L 291.700 144.472 291.762 143.786 C 292.536 135.259,296.791 131.773,303.612 134.079 C 306.137 134.933,307.267 134.169,307.267 131.606 C 307.267 127.462,302.018 124.648,296.823 126.009 M141.300 128.268 C 138.923 129.055,137.200 130.522,137.200 131.758 C 137.200 131.966,137.630 132.983,138.156 134.018 C 139.726 137.109,140.229 141.487,139.803 148.341 C 139.595 151.683,139.425 153.150,138.392 160.500 C 137.143 169.380,139.547 172.237,148.524 172.541 C 158.799 172.889,165.496 169.600,164.573 164.659 C 164.194 162.631,163.636 162.488,160.413 163.593 C 154.388 165.660,147.531 165.654,145.558 163.579 C 144.149 162.099,143.894 157.723,144.782 150.300 C 146.071 139.541,146.248 137.713,146.267 135.000 C 146.308 128.948,144.921 127.068,141.300 128.268 M269.250 129.621 C 265.704 131.377,265.910 136.665,269.566 137.728 C 273.463 138.861,276.902 134.953,275.224 131.300 C 274.336 129.367,271.419 128.547,269.250 129.621 M179.400 144.122 C 174.404 144.733,168.684 147.982,167.993 150.600 C 167.278 153.311,168.456 155.247,170.250 154.311 C 170.553 154.153,170.800 154.051,170.800 154.084 C 170.800 154.117,170.480 154.836,170.089 155.682 C 166.508 163.433,168.978 170.730,175.721 172.317 C 185.170 174.540,193.654 167.013,193.660 156.400 C 193.665 147.940,188.009 143.070,179.400 144.122 M210.400 144.122 C 206.537 144.595,202.005 146.697,199.954 148.967 C 197.744 151.412,198.977 155.955,201.391 154.264 C 201.759 154.006,201.842 153.994,201.748 154.214 C 201.681 154.371,201.301 155.236,200.905 156.137 C 197.600 163.641,200.164 170.774,206.721 172.317 C 217.584 174.873,226.994 164.210,224.284 152.413 C 222.966 146.672,217.286 143.280,210.400 144.122 M248.720 144.328 C 245.234 145.076,241.724 147.897,239.342 151.868 L 238.641 153.036 238.749 150.923 C 239.059 144.861,235.711 142.293,231.366 145.262 C 228.507 147.216,228.024 149.583,230.276 150.604 C 234.199 152.382,234.416 157.039,231.407 174.858 C 229.155 188.191,229.613 190.501,234.499 190.470 C 238.473 190.445,241.941 186.165,239.225 184.638 C 236.766 183.256,236.102 179.655,236.969 172.400 C 237.331 169.371,237.275 169.462,238.257 170.303 C 244.593 175.726,254.703 171.556,258.388 162.000 C 262.536 151.244,257.699 142.403,248.720 144.328 M268.900 144.550 C 266.637 145.360,264.800 147.265,264.800 148.802 C 264.800 149.636,265.320 150.214,266.877 151.108 C 268.300 151.926,268.692 152.889,268.662 155.500 C 268.639 157.562,268.485 158.429,267.422 162.463 C 265.418 170.075,267.590 173.748,273.122 172.105 C 275.651 171.354,277.746 167.881,276.287 166.859 C 272.783 164.407,272.615 163.750,273.838 157.277 C 275.745 147.191,274.011 142.721,268.900 144.550 M326.349 144.407 C 322.087 145.467,320.218 148.354,322.271 150.704 C 326.303 155.317,323.415 163.244,317.100 164.897 C 314.448 165.591,313.940 165.126,313.609 161.700 C 312.303 148.164,309.168 142.678,303.891 144.693 C 300.827 145.863,299.716 151.048,302.436 151.483 C 305.369 151.952,307.888 157.601,309.183 166.612 C 310.079 172.848,313.055 174.473,317.726 171.275 L 319.057 170.364 318.308 171.732 C 316.177 175.628,312.965 179.927,310.957 181.572 C 307.931 184.051,306.127 184.055,303.990 181.588 L 302.924 180.357 301.765 180.441 C 297.161 180.774,296.664 187.538,301.084 189.701 C 309.725 193.928,320.799 182.338,327.723 161.820 C 331.918 149.393,331.424 143.145,326.349 144.407 M183.746 151.440 C 192.360 153.268,189.868 165.780,180.886 165.798 C 174.554 165.810,171.884 159.765,175.441 153.470 C 176.683 151.270,179.594 150.559,183.746 151.440 M214.897 151.438 C 219.320 152.564,221.336 157.191,219.250 161.429 C 216.507 167.001,207.803 167.297,205.368 161.900 C 203.929 158.710,205.733 152.516,208.341 151.696 C 210.505 151.015,212.870 150.922,214.897 151.438 M251.719 151.954 C 256.217 154.276,255.184 162.238,250.073 164.640 C 246.957 166.104,242.371 165.307,239.568 162.815 L 238.764 162.100 239.274 160.747 C 242.040 153.411,247.318 149.682,251.719 151.954 " stroke="none" fill="#43f2e2" fill-rule="evenodd"></path><path id="path1" d="M0.000 150.000 L 0.000 300.000 200.000 300.000 L 400.000 300.000 400.000 150.000 L 400.000 0.000 200.000 0.000 L 0.000 0.000 0.000 150.000 M117.600 149.400 L 117.600 189.400 116.400 189.400 L 115.200 189.400 115.200 149.400 L 115.200 109.400 116.400 109.400 L 117.600 109.400 117.600 149.400 M78.123 125.650 C 79.985 128.230,83.480 131.415,89.600 136.106 C 102.452 145.958,104.583 149.810,100.214 155.286 C 98.899 156.934,98.321 156.989,99.184 155.384 C 102.358 149.481,99.618 145.264,89.400 140.324 C 85.892 138.628,79.017 136.200,77.722 136.200 C 77.661 136.200,77.586 143.468,77.556 152.350 C 77.503 167.698,77.481 168.535,77.125 169.200 C 73.954 175.121,60.780 178.473,56.532 174.439 C 51.050 169.233,66.527 160.756,75.050 164.297 C 75.382 164.435,75.400 163.416,75.400 144.521 L 75.400 124.600 76.383 124.600 C 77.339 124.600,77.387 124.629,78.123 125.650 M302.441 125.996 C 306.119 127.132,308.379 130.672,307.078 133.260 C 306.343 134.724,305.568 134.881,303.100 134.067 C 296.717 131.961,293.023 135.032,291.900 143.380 L 291.754 144.461 292.627 144.341 C 299.289 143.430,301.228 144.221,300.761 147.659 C 300.293 151.095,299.404 151.773,295.932 151.342 C 294.485 151.162,292.835 150.972,292.267 150.919 L 291.234 150.823 291.115 151.761 C 290.341 157.866,290.482 171.047,291.389 177.300 C 292.124 182.369,290.430 184.843,286.201 184.873 C 283.703 184.890,283.286 184.152,283.469 180.035 C 283.639 176.196,285.399 156.126,285.934 151.927 L 286.058 150.954 284.779 151.119 C 281.648 151.523,281.198 151.206,281.203 148.600 C 281.208 146.156,281.810 145.684,285.941 144.882 C 286.260 144.821,286.410 144.617,286.480 144.148 C 286.534 143.792,286.761 142.150,286.984 140.500 C 288.044 132.685,290.096 128.986,294.653 126.674 C 296.875 125.547,300.082 125.268,302.441 125.996 M144.593 128.273 C 146.629 129.211,146.885 133.807,145.527 145.100 C 143.343 163.268,143.695 164.645,150.600 164.941 C 154.008 165.087,156.882 164.655,160.440 163.461 C 163.538 162.421,163.912 162.462,164.517 163.909 C 166.581 168.850,160.071 172.670,149.600 172.663 C 138.869 172.655,136.927 169.996,138.670 157.700 C 140.413 145.398,140.209 138.236,137.991 133.899 C 136.791 131.552,136.800 131.220,138.102 130.020 C 140.118 128.161,142.789 127.443,144.593 128.273 M272.965 129.308 C 275.101 129.943,276.111 131.837,275.608 134.263 C 274.454 139.819,266.144 139.017,266.653 133.399 C 266.946 130.173,269.752 128.354,272.965 129.308 M184.958 144.316 C 190.749 145.504,193.690 149.573,193.693 156.400 C 193.698 166.041,187.738 172.600,178.900 172.679 C 169.919 172.759,165.728 164.908,169.910 155.839 C 170.554 154.443,170.564 154.385,170.142 154.530 C 168.525 155.084,167.749 154.229,167.763 151.907 C 167.777 149.477,169.184 147.920,173.192 145.903 C 176.826 144.075,181.022 143.509,184.958 144.316 M215.958 144.316 C 229.138 147.020,227.212 168.955,213.500 172.328 C 202.612 175.006,195.877 165.739,201.141 155.322 C 201.550 154.513,201.577 154.366,201.299 154.473 C 197.906 155.775,197.750 150.304,201.108 147.751 C 205.241 144.608,210.947 143.288,215.958 144.316 M236.830 144.515 C 238.240 145.245,238.889 147.015,238.889 150.130 L 238.889 152.361 239.679 151.130 C 247.047 139.653,260.672 142.494,259.909 155.349 C 259.123 168.593,246.984 177.161,238.373 170.549 L 237.445 169.837 237.331 170.569 C 236.138 178.227,236.681 182.841,238.953 184.359 C 240.559 185.433,240.636 186.217,239.328 188.193 C 237.058 191.624,231.196 191.399,230.209 187.844 C 229.662 185.874,229.930 182.974,231.577 173.078 C 234.200 157.315,233.999 152.483,230.655 150.907 C 229.040 150.147,228.800 149.888,228.800 148.908 C 228.800 145.778,233.889 142.994,236.830 144.515 M272.840 144.520 C 274.882 145.577,275.283 149.797,274.005 156.800 C 272.771 163.566,272.910 164.503,275.385 166.104 C 277.160 167.252,277.264 167.575,276.417 169.296 C 275.177 171.815,272.615 173.005,269.726 172.405 C 266.395 171.714,265.737 168.484,267.536 161.654 C 269.248 155.154,268.975 152.580,266.396 150.911 C 264.199 149.490,264.054 148.448,265.790 146.549 C 267.807 144.342,270.819 143.475,272.840 144.520 M307.444 144.409 C 310.494 145.256,312.596 151.013,313.698 161.532 C 314.054 164.927,314.181 165.104,316.151 164.946 C 322.631 164.427,326.346 155.763,322.216 150.800 C 320.328 148.531,321.043 146.792,324.600 144.997 C 329.147 142.703,331.524 145.312,330.513 151.486 C 328.374 164.545,319.996 181.631,312.955 187.295 C 307.109 191.998,299.571 191.589,298.088 186.489 C 296.810 182.091,301.503 178.170,304.033 181.521 C 307.011 185.465,311.491 182.747,317.083 173.602 C 318.786 170.816,318.878 170.567,317.942 171.282 C 313.560 174.624,309.889 172.805,309.098 166.900 C 308.373 161.491,307.079 156.972,305.432 154.100 C 304.301 152.126,304.043 151.933,301.964 151.509 C 301.090 151.330,300.800 150.884,300.800 149.718 C 300.800 145.837,303.840 143.408,307.444 144.409 M178.100 151.600 C 177.330 151.807,176.637 151.982,176.559 151.988 C 175.734 152.056,174.000 156.644,174.000 158.757 C 174.000 163.260,176.292 165.500,180.900 165.500 C 186.276 165.500,189.374 162.024,188.768 156.670 C 188.296 152.506,183.392 150.175,178.100 151.600 M209.000 151.614 C 207.304 152.057,207.157 152.196,206.107 154.336 C 204.784 157.031,204.616 160.102,205.673 162.263 C 208.036 167.093,216.611 166.605,219.109 161.499 C 222.244 155.092,216.644 149.617,209.000 151.614 M247.400 151.669 C 244.097 152.427,241.390 155.461,239.472 160.555 C 238.824 162.277,238.812 162.246,240.515 163.384 C 246.961 167.696,254.300 164.457,254.300 157.300 C 254.300 152.912,251.598 150.706,247.400 151.669 " stroke="none" fill="#040404" fill-rule="evenodd"></path><path id="path2" d="M115.298 149.400 C 115.298 171.455,115.321 180.478,115.350 169.450 C 115.379 158.423,115.379 140.378,115.350 129.350 C 115.321 118.322,115.298 127.345,115.298 149.400 M75.850 124.743 C 76.153 124.789,76.648 124.789,76.950 124.743 C 77.252 124.697,77.005 124.660,76.400 124.660 C 75.795 124.660,75.547 124.697,75.850 124.743 M80.700 128.800 C 81.130 129.240,81.526 129.600,81.581 129.600 C 81.636 129.600,81.330 129.240,80.900 128.800 C 80.470 128.360,80.074 128.000,80.019 128.000 C 79.964 128.000,80.270 128.360,80.700 128.800 M291.287 129.050 L 290.700 129.700 291.350 129.113 C 291.956 128.565,292.092 128.400,291.937 128.400 C 291.903 128.400,291.610 128.692,291.287 129.050 M275.650 133.100 C 275.653 133.540,275.694 133.696,275.741 133.448 C 275.789 133.199,275.787 132.839,275.737 132.648 C 275.687 132.456,275.648 132.660,275.650 133.100 M77.495 152.000 C 77.495 160.745,77.520 164.322,77.550 159.950 C 77.580 155.577,77.580 148.422,77.550 144.050 C 77.520 139.677,77.495 143.255,77.495 152.000 M238.846 150.600 C 238.846 150.985,238.888 151.143,238.938 150.950 C 238.988 150.758,238.988 150.442,238.938 150.250 C 238.888 150.058,238.846 150.215,238.846 150.600 M144.254 157.200 C 144.254 157.695,144.293 157.898,144.341 157.650 C 144.389 157.403,144.389 156.998,144.341 156.750 C 144.293 156.503,144.254 156.705,144.254 157.200 M254.446 157.200 C 254.446 157.585,254.488 157.743,254.538 157.550 C 254.588 157.358,254.588 157.043,254.538 156.850 C 254.488 156.658,254.446 156.815,254.446 157.200 M290.646 157.600 C 290.646 157.985,290.688 158.143,290.738 157.950 C 290.788 157.758,290.788 157.442,290.738 157.250 C 290.688 157.058,290.646 157.215,290.646 157.600 M246.053 165.344 C 246.357 165.389,246.807 165.388,247.053 165.341 C 247.299 165.293,247.050 165.256,246.500 165.257 C 245.950 165.259,245.749 165.298,246.053 165.344 M180.453 165.744 C 180.757 165.789,181.207 165.788,181.453 165.741 C 181.699 165.693,181.450 165.656,180.900 165.657 C 180.350 165.659,180.149 165.698,180.453 165.744 M211.453 165.744 C 211.757 165.789,212.207 165.788,212.453 165.741 C 212.699 165.693,212.450 165.656,211.900 165.657 C 211.350 165.659,211.149 165.698,211.453 165.744 M147.952 172.741 C 148.201 172.789,148.561 172.787,148.752 172.737 C 148.944 172.687,148.740 172.648,148.300 172.650 C 147.860 172.653,147.704 172.694,147.952 172.741 M150.350 172.741 C 150.597 172.789,151.003 172.789,151.250 172.741 C 151.498 172.693,151.295 172.654,150.800 172.654 C 150.305 172.654,150.103 172.693,150.350 172.741 M177.650 172.738 C 177.843 172.788,178.158 172.788,178.350 172.738 C 178.543 172.688,178.385 172.646,178.000 172.646 C 177.615 172.646,177.458 172.688,177.650 172.738 M208.650 172.738 C 208.843 172.788,209.157 172.788,209.350 172.738 C 209.543 172.688,209.385 172.646,209.000 172.646 C 208.615 172.646,208.457 172.688,208.650 172.738 M210.250 172.738 C 210.443 172.788,210.757 172.788,210.950 172.738 C 211.143 172.688,210.985 172.646,210.600 172.646 C 210.215 172.646,210.058 172.688,210.250 172.738 M236.667 178.400 C 236.667 179.225,236.703 179.563,236.746 179.150 C 236.789 178.738,236.789 178.063,236.746 177.650 C 236.703 177.238,236.667 177.575,236.667 178.400 M301.650 180.338 C 301.843 180.388,302.157 180.388,302.350 180.338 C 302.543 180.288,302.385 180.246,302.000 180.246 C 301.615 180.246,301.457 180.288,301.650 180.338 M297.850 185.100 C 297.853 185.540,297.894 185.696,297.941 185.448 C 297.989 185.199,297.987 184.839,297.937 184.648 C 297.887 184.456,297.848 184.660,297.850 185.100 M314.491 185.850 L 313.700 186.700 314.550 185.909 C 315.018 185.475,315.400 185.092,315.400 185.059 C 315.400 184.908,315.226 185.060,314.491 185.850 " stroke="none" fill="#185c56" fill-rule="evenodd"></path><path id="path3" d="M139.872 144.800 C 139.872 145.845,139.906 146.273,139.947 145.750 C 139.988 145.228,139.988 144.373,139.947 143.850 C 139.906 143.328,139.872 143.755,139.872 144.800 M296.650 144.143 C 296.953 144.189,297.447 144.189,297.750 144.143 C 298.053 144.097,297.805 144.060,297.200 144.060 C 296.595 144.060,296.348 144.097,296.650 144.143 M330.654 148.800 C 330.654 149.295,330.693 149.498,330.741 149.250 C 330.789 149.003,330.789 148.597,330.741 148.350 C 330.693 148.103,330.654 148.305,330.654 148.800 M274.660 150.200 C 274.660 150.805,274.697 151.053,274.743 150.750 C 274.789 150.447,274.789 149.953,274.743 149.650 C 274.697 149.347,274.660 149.595,274.660 150.200 M180.650 151.138 C 180.843 151.188,181.158 151.188,181.350 151.138 C 181.543 151.088,181.385 151.046,181.000 151.046 C 180.615 151.046,180.458 151.088,180.650 151.138 M211.650 151.138 C 211.843 151.188,212.157 151.188,212.350 151.138 C 212.543 151.088,212.385 151.046,212.000 151.046 C 211.615 151.046,211.457 151.088,211.650 151.138 M268.657 155.300 C 268.659 155.850,268.698 156.051,268.744 155.747 C 268.789 155.443,268.788 154.993,268.741 154.747 C 268.693 154.501,268.656 154.750,268.657 155.300 M290.474 162.800 C 290.474 163.955,290.507 164.428,290.547 163.850 C 290.588 163.273,290.588 162.328,290.547 161.750 C 290.507 161.173,290.474 161.645,290.474 162.800 M199.446 162.000 C 199.446 162.385,199.488 162.543,199.538 162.350 C 199.588 162.158,199.588 161.843,199.538 161.650 C 199.488 161.458,199.446 161.615,199.446 162.000 M199.446 163.400 C 199.446 163.785,199.488 163.942,199.538 163.750 C 199.588 163.558,199.588 163.243,199.538 163.050 C 199.488 162.858,199.446 163.015,199.446 163.400 M69.950 163.541 C 70.198 163.589,70.603 163.589,70.850 163.541 C 71.098 163.493,70.895 163.454,70.400 163.454 C 69.905 163.454,69.703 163.493,69.950 163.541 M150.546 165.144 C 150.901 165.189,151.531 165.189,151.946 165.146 C 152.360 165.103,152.070 165.067,151.300 165.066 C 150.530 165.065,150.190 165.100,150.546 165.144 M290.470 166.600 C 290.470 167.535,290.504 167.918,290.546 167.450 C 290.589 166.983,290.589 166.218,290.546 165.750 C 290.504 165.283,290.470 165.665,290.470 166.600 M57.287 168.450 L 56.700 169.100 57.350 168.513 C 57.956 167.965,58.092 167.800,57.937 167.800 C 57.903 167.800,57.610 168.093,57.287 168.450 M61.950 176.145 C 62.308 176.189,62.892 176.189,63.250 176.145 C 63.608 176.100,63.315 176.064,62.600 176.064 C 61.885 176.064,61.593 176.100,61.950 176.145 M311.989 180.550 L 311.300 181.300 312.050 180.611 C 312.748 179.969,312.892 179.800,312.739 179.800 C 312.706 179.800,312.368 180.138,311.989 180.550 M283.450 180.700 C 283.453 181.140,283.494 181.296,283.541 181.048 C 283.589 180.799,283.587 180.439,283.537 180.248 C 283.487 180.056,283.448 180.260,283.450 180.700 " stroke="none" fill="#24847c" fill-rule="evenodd"></path><path id="path4" d="M117.498 149.400 C 117.498 171.455,117.521 180.478,117.550 169.450 C 117.579 158.423,117.579 140.378,117.550 129.350 C 117.521 118.322,117.498 127.345,117.498 149.400 " stroke="none" fill="#247b74" fill-rule="evenodd"></path></g></svg>
      </div>

      
      <div>
        {playingTunes.size != 0 && <button
        onClick={stopAllAudio}
        className="flex items-center self-end justify-center p-3 m-4 text-white transition-colors bg-red-500 rounded-full hover:bg-red-600"
      >
        <FaStop/>
      </button>}
      </div>
    </div>
    
      <div className="relative w-[90vw] md:w-[80vw] lg:w-[70vw] xl:w-[60vw] mx-auto">
      <div className="absolute inset-y-0 left-0 z-10 w-8 bg-gradient-to-r from-black to-transparent" />
      <div className="absolute inset-y-0 right-0 z-10 w-8 bg-gradient-to-l from-black to-transparent" />
      
      <div className="flex items-start flex-wrap p-1
        h-[80vh] overflow-y-auto
        text-lime-300 border-4 border-cyan-200 
        justify-center gap-4 rounded-lg
        scrollbar-thin scrollbar-thumb-lime-500 scrollbar-track-transparent
        hover:scrollbar-thumb-lime-400  
        w-[90vw] md:w-[80vw] lg:w-[70vw] xl:w-[60vw] 
       min-h-[50vh] my-8
      ">
        
        <div className="flex flex-wrap items-center justify-center gap-4 p-2">
          {tunes.map((tune, index) => (
            <div 
            key={index} 
            className="flex flex-col items-center w-26 h-26" 
          >
              <div className=""> {/* Takes available space for tile */}
                <TuneTile
                  icon={tune.icon}
                  title={tune.title}
                  onClick={() => handleTileClick(tune.title)}
                  isPlaying={playingTunes.has(tune.title)}
                />
              </div>
              
              <div className="w-full h-6">
               {playingTunes.has(tune.title)&& (
                 <div className="relative w-full group">
                   <input
                     type="range"
                     min="0"
                     max="1"
                     step="0.01"
                     value={volumes.get(tune.title) ?? 1}
                     onChange={(e) => handleVolumeChange(tune.title, parseFloat(e.target.value))}
                     className="w-28 h-1 transition-all duration-200 rounded-xl appearance-none cursor-pointer bg-[#00ffff] accent-lime-500 focus:outline-none focus:ring-1 focus:ring-lime-300"
                   />
                   <div className="absolute left-0 text-xs transition-opacity opacity-0 -bottom-4 group-hover:opacity-100 text-cyan-300">
                     {Math.round((volumes.get(tune.title) ?? 1) * 100)}%
                   </div>
                 </div>
               )}
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  </main>
  );
};

export default App;